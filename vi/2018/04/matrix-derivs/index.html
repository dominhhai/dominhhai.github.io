<!doctype html><html lang=vi><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=generator content="Hugo 0.41 with theme Tranquilpeak 0.4.1-BETA"><title>[Giải Tích] Đạo hàm với vec-tơ, ma trận, ten-xơ</title><meta name=author content="Do Minh Hai"><meta name=keywords content="Calculus,Giải Tích,Đạo Hàm vertor,matrix,tensor,dominhhai,programming,computer science,machine learning,deep learning"><link rel=icon href=https://dominhhai.github.io/favicon/golden-buddha-512-79567.png><link rel=canonical href=https://dominhhai.github.io/vi/2018/04/matrix-derivs/><meta name=description content="Bài viết này sẽ giới thiệu cách lấy đạo hàm của vec-tơ, ma trận và ten-xơ (mảng nhiều chiều) và lấy đạo hàm theo vec-tơ, ma trận và ten-xơ.
1. Quy hoạch động Làm quá nhiều việc 1 lúc rất dễ dẫn tới sai lầm, chính vì vậy mà người ta cần phân tách vấn đề ra thành các bài toán con để giải quyết rồi gộp kết quả lại."><meta property=og:type content=website><meta property=og:title content="[Giải Tích] Đạo hàm với vec-tơ, ma trận, ten-xơ"><meta property=og:url content=https://dominhhai.github.io/vi/2018/04/matrix-derivs/><meta property=og:description content="Bài viết này sẽ giới thiệu cách lấy đạo hàm của vec-tơ, ma trận và ten-xơ (mảng nhiều chiều) và lấy đạo hàm theo vec-tơ, ma trận và ten-xơ.
1. Quy hoạch động Làm quá nhiều việc 1 lúc rất dễ dẫn tới sai lầm, chính vì vậy mà người ta cần phân tách vấn đề ra thành các bài toán con để giải quyết rồi gộp kết quả lại."><meta property=og:site_name content="Hai's Blog"><meta property=og:locale content=vi><meta name=twitter:card content=summary><meta name=twitter:title content="[Giải Tích] Đạo hàm với vec-tơ, ma trận, ten-xơ"><meta name=twitter:url content=https://dominhhai.github.io/vi/2018/04/matrix-derivs/><meta name=twitter:description content="Bài viết này sẽ giới thiệu cách lấy đạo hàm của vec-tơ, ma trận và ten-xơ (mảng nhiều chiều) và lấy đạo hàm theo vec-tơ, ma trận và ten-xơ.
1. Quy hoạch động Làm quá nhiều việc 1 lúc rất dễ dẫn tới sai lầm, chính vì vậy mà người ta cần phân tách vấn đề ra thành các bài toán con để giải quyết rồi gộp kết quả lại."><meta name=twitter:creator content=@minhhai3b><meta property=fb:app_id content=333198270561466><meta property=og:image content=https://res.cloudinary.com/dominhhai/image/upload/math/katex.png><meta name=twitter:image content=https://res.cloudinary.com/dominhhai/image/upload/math/katex.png><meta property=og:image content="https://www.gravatar.com/avatar/711b36be8e444cd1d60b348077bfd752?s=640"><meta name=twitter:image content="https://www.gravatar.com/avatar/711b36be8e444cd1d60b348077bfd752?s=640"><link rel=publisher href=https://plus.google.com/115106277658014197977><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin=anonymous><link rel=stylesheet href=https://dominhhai.github.io/css/style-jsjn0006wyhpyzivf6yceb31gvpjatbcs3qzjvlumobfnugccvobqwxnnaj8.min.css><link rel=stylesheet crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css integrity=sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei><link rel=stylesheet href=https://dominhhai.github.io/css/main.css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-105333519-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)};gtag('js',new Date());gtag('config','UA-105333519-1');</script></head><body><div id=blog><header id=header data-behavior=5><i id=btn-open-sidebar class="fa fa-lg fa-bars"></i><div class=header-title><a class=header-title-link href=https://dominhhai.github.io/vi/>Hai&#39;s Blog</a></div><a class=header-right-picture href=https://dominhhai.github.io/#about><img class=header-picture src="https://www.gravatar.com/avatar/711b36be8e444cd1d60b348077bfd752?s=90" alt="Ảnh đại diện"></a></header><nav id=sidebar data-behavior=5><div class=sidebar-container><div class=sidebar-profile><a href=https://dominhhai.github.io/#about><img class=sidebar-profile-picture src="https://www.gravatar.com/avatar/711b36be8e444cd1d60b348077bfd752?s=110" alt="Ảnh đại diện"></a><h4 class=sidebar-profile-name>Do Minh Hai</h4><h5 class=sidebar-profile-bio>Just a developer<br>Enjoy life as a journey</h5></div><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://dominhhai.github.io/vi/><i class="sidebar-button-icon fa fa-lg fa-home"></i><span class=sidebar-button-desc>Trang chủ</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://dominhhai.github.io/vi/categories/><i class="sidebar-button-icon fa fa-lg fa-bookmark"></i><span class=sidebar-button-desc>Danh mục</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://dominhhai.github.io/vi/tags/><i class="sidebar-button-icon fa fa-lg fa-tags"></i><span class=sidebar-button-desc>Thẻ thông tin</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://dominhhai.github.io/vi/archives/><i class="sidebar-button-icon fa fa-lg fa-archive"></i><span class=sidebar-button-desc>Lưu trữ</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://dominhhai.github.io/vi/talk/><i class="sidebar-button-icon fa fa-lg fa-child"></i><span class=sidebar-button-desc>Chém gió</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://dominhhai.github.io/vi/page/why/><i class="sidebar-button-icon fa fa-lg fa-question"></i><span class=sidebar-button-desc>Hỏi ngu</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://github.com/dominhhai target=_blank rel=noopener><i class="sidebar-button-icon fa fa-lg fa-github"></i><span class=sidebar-button-desc>GitHub</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://twitter.com/minhhai3b target=_blank rel=noopener><i class="sidebar-button-icon fa fa-lg fa-twitter"></i><span class=sidebar-button-desc>Twitter</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://dominhhai.github.io/vi/index.xml><i class="sidebar-button-icon fa fa-lg fa-rss"></i><span class=sidebar-button-desc>RSS</span></a></li></ul></div></nav><div id=main data-behavior=5 class=hasCoverMetaIn><article class=post itemscope itemtype=http://schema.org/BlogPosting><div class="post-header main-content-wrap text-center"><h1 class=post-title itemprop=headline>[Giải Tích] Đạo hàm với vec-tơ, ma trận, ten-xơ</h1><div class="postShorten-meta post-meta"><time itemprop=datePublished datetime=2018-04-24T00:00:00Z>24 tháng 4, 2018</time>
<span>mục</span>
<a class=category-link href=https://dominhhai.github.io/vi/categories/to%c3%a1n>Toán</a>,
<a class=category-link href=https://dominhhai.github.io/vi/categories/gi%e1%ba%a3i-t%c3%adch>Giải Tích</a></div></div><div class="post-content markdown" itemprop=articleBody><div class=main-content-wrap><p>Bài viết này sẽ giới thiệu cách lấy đạo hàm của vec-tơ, ma trận và ten-xơ (mảng nhiều chiều) và lấy đạo hàm theo vec-tơ, ma trận và ten-xơ.</p><h1 id=table-of-contents>Mục lục</h1><nav id=TableOfContents><ul><li><a href=#1-quy-hoạch-động>1. Quy hoạch động</a><ul><li><a href=#1-1-phân-rã-các-thành-phần>1.1. Phân rã các thành phần</a></li><li><a href=#1-2-bỏ-các-kí-hiệu-cộng-nhân>1.2. Bỏ các kí hiệu cộng, nhân</a></li><li><a href=#1-3-gộp-kết-quả-lại>1.3. Gộp kết quả lại</a></li><li><a href=#1-4-hoán-đổi-vec-tơ-cột-với-hàng>1.4. Hoán đổi vec-tơ cột với hàng</a></li></ul></li><li><a href=#2-trên-2-chiều-thì-làm-thế-nào>2. Trên 2 chiều thì làm thế nào?</a></li><li><a href=#2-1-ví-dụ-1>2.1. Ví dụ 1</a></li><li><a href=#2-2-ví-dụ-2>2.2. Ví dụ 2</a></li><li><a href=#3-quy-tắc-chuỗi>3. Quy tắc chuỗi</a></li></ul></nav><h1 id=1-quy-hoạch-động>1. Quy hoạch động</h1><p>Làm quá nhiều việc 1 lúc rất dễ dẫn tới sai lầm, chính vì vậy mà người ta cần phân tách vấn đề ra thành các bài toán con để giải quyết rồi gộp kết quả lại. Việc tính đạo hàm vec-tơ, ma trận hay ten-xơ cũng vậy khi tính đạo hàm ta có thể gặp sai sót nếu tính đạo hàm cho nhiều thành phần đồng thời, lấy đạo hàm của các thành phần có các kí hiệu gộp như cộng, nhân, áp dụng quy tắc chuỗi cho nhiều thành phần cùng lúc. Chính vì vậy để dễ dàng hơn, trước hết ta cần phân tách ra các thành phần riêng rẽ để cho đỡ nhầm.</p><h2 id=1-1-phân-rã-các-thành-phần>1.1. Phân rã các thành phần</h2><p>Để đơn giản cho việc tính toán, trước tiên ta phân rã biểu thức ra thành các thành phần biến đơn lẻ. Bởi khi biểu diễn thông qua các biến đơn lẻ này, ta có thể dễ dàng lấy được đạo hàm như cách ta làm với các hàm đại số thông thường.</p><p>Ví dụ, giả sử ta có véc-tơ cột $\mathbf{y}\in\mathbb{R}^{n1}$ được tạo bởi tích của ma trận $\mathbf{W}\in\mathbb{R}^{nm}$ và vec-tơ cột $\mathbf{x}\in\mathbb{R}^{m1}$:</p><p>$$\mathbf{y}=\mathbf{W}\mathbf{x}$$</p><p>Giờ ta muốn lấy đạo hàm của $\mathbf{y}$ theo $\mathbf{x}$. Dễ dàng thấy, ta sẽ có $n\times m$ đạo hàm riêng của $n$ từng thành phần véc-tơ $\mathbf{y}$ theo mỗi $m$ thành phần của véc-tơ $\mathbf{x}$.</p><p>Đặt $\dfrac{\partial{y_3}}{\partial{x_7}}$ là đạo hàm riêng của thành phần thứ 3 của véc-tơ $\mathbf{y}$ theo thành phần thứ 7 của véc-tơ $\mathbf{x}$. Để tính đạo hàm riêng này, trước tiên ta viết công thức của tính $y_3$ ra như sau:</p><p>$$y_3=\sum_{j=1}^mW_{3,j}x_j$$</p><p>Như vậy thay vì nhìn cả ma trận phức tạp, ta bóc tách thành phần cần tính $y_3$ ra đơn giản hơn nhiều.</p><h2 id=1-2-bỏ-các-kí-hiệu-cộng-nhân>1.2. Bỏ các kí hiệu cộng, nhân</h2><p>Nhìn các kí hiệu cộng, nhân ta chưa nhìn thấy ngay được sự phụ thuộc của các phần tử trong công thức, nên bước loại bỏ các kí hiệu này giúp ta có cái nhìn trực quan hơn về biến phụ thuộc.</p><p>Ở ví dụ trên ta viết lại $y_3$ như sau:</p><p>$$y_3=W_{3,1}x_1+W_{3,2}x_2+\ldots+W_{3,7}x_7+\ldots+W_{3,m}x_m$$</p><p>Từ đây ta có thể thấy $y_3$ phụ thuộc vào $x_7$ chỉ đơn giản bằng một tích $W_{3,7}x_7$, nên đạo hàm của $y_3$ theo $x_7$ sẽ bằng $W_{3,7}$:</p><p>$$
\begin{aligned}
\frac{\partial{y_3}}{\partial{x_7}} &amp;= \frac{\partial}{\partial{x_7}}\Big(W_{3,1}x_1+W_{3,2}x_2+\ldots+W_{3,7}x_7+\ldots+W_{3,m}x_m\Big)
\cr
&amp;= 0 + 0 + \ldots + W_{3,7} + \ldots + 0
\cr
&amp;= W_{3,7}
\end{aligned}
$$</p><p>Tương tự với các thành phần khác của $y$ và $x$ ta sẽ có:</p><p>$$\dfrac{\partial{y_i}}{\partial{x_j}}=W_{i,j}$$</p><h2 id=1-3-gộp-kết-quả-lại>1.3. Gộp kết quả lại</h2><p>Nhóm kết quả lại ta sẽ thu được ma trận Jacobi $\mathbf{J}\in\mathbb{R}^{nm}$:</p><p>$$
\begin{bmatrix}
\dfrac{\partial{y_1}}{\partial{x_1}} &amp; \dfrac{\partial{y_1}}{\partial{x_2}} &amp; \dots &amp; \dfrac{\partial{y_1}}{\partial{x_m}}
\cr\cr
\dfrac{\partial{y_2}}{\partial{x_1}} &amp; \dfrac{\partial{y_2}}{\partial{x_2}} &amp; \dots &amp; \dfrac{\partial{y_2}}{\partial{x_m}}
\cr\cr
\vdots &amp; \vdots &amp; \ddots &amp; \vdots
\cr\cr
\dfrac{\partial{y_n}}{\partial{x_1}} &amp; \dfrac{\partial{y_n}}{\partial{x_2}} &amp; \dots &amp; \dfrac{\partial{y_n}}{\partial{x_m}}
\end{bmatrix}
=\begin{bmatrix}
W_{1,1} &amp; W_{1,2} &amp; \dots &amp; W_{1,m}
\cr\cr
W_{2,1} &amp; W_{1,2} &amp; \dots &amp; W_{2,m}
\cr\cr
\vdots &amp; \vdots &amp; \ddots &amp; \vdots
\cr\cr
W_{n,1} &amp; W_{n,2} &amp; \dots &amp; W_{n,m}
\end{bmatrix}
$$</p><p>Điều này tương đương với chuyện đạo hàm của $\mathbf{y}=\mathbf{W}\mathbf{x}$ theo $\mathbf{x}$ chính là ma trận $\mathbf{W}$:
$$\frac{d\mathbf{y}}{d\mathbf{x}}=\mathbf{W}$$</p><p>Bằng phép phân tích như trên, ta có thể thấy việc tính đạo hàm không hề khó khăn nếu ta cứ bóc tách nhỏ tầng thành phần ra để tính riêng biệt rồi gộp kết quả lại.</p><h2 id=1-4-hoán-đổi-vec-tơ-cột-với-hàng>1.4. Hoán đổi vec-tơ cột với hàng</h2><p>Tương tự nếu, $\mathbf{y}\in\mathbb{R}^{1n}$ là véc-tơ hàng được tạo bởi tích của vec-tơ hàng $\mathbf{x}\in\mathbb{R}^{1m}$ ma trận $\mathbf{W}\in\mathbb{R}^{mn}$:</p><p>$$\mathbf{y}=\mathbf{x}\mathbf{W}$$</p><p>Thì đạo hàm riêng:</p><p>$$\dfrac{\partial{y_i}}{\partial{x_j}}=W_{j,i}$$</p><p>Như vậy, đạo hàm của véc-tơ $\mathbf{y}$ theo véc-tơ $\mathbf{x}$ là:
$$\frac{d\mathbf{y}}{d\mathbf{x}}=\mathbf{W}$$</p><h1 id=2-trên-2-chiều-thì-làm-thế-nào>2. Trên 2 chiều thì làm thế nào?</h1><h1 id=2-1-ví-dụ-1>2.1. Ví dụ 1</h1><p>Giờ ta thử tính đạo hàm của véc-tơ $\mathbf{y}$ theo ma trận $\mathbf{W}$ xem sao:
$$\frac{d\mathbf{y}}{d\mathbf{W}}$$</p><p>Lúc này, $\mathbf{y}$ là dữ liệu 1 chiều còn $\mathbf{W}$ là dữ liệu 2 chiều, nên đạo hàm sẽ ở dạng dữ liệu mảng 3 chiều (ten-xơ 3 chiều).</p><p>Tương tự như phép phân tích ở trên, ta thí dụ tính đạo hàm riêng của $y_3$ là phần tử thứ 3 của véc-tơ $\mathbf{y}$ theo $W_{7,8}$ là phần tử ở hàng 7, cột 8 của ma trận $\mathbf{W}$:</p><p>$$y_3=x_1W_{1,3}+x_2W_{2,3}+\dots+x_mW_{m,3}$$</p><p>Ở đây, rõ ràng là $y_3$ khônng hề phụ thuộc vào $W_{7,8}$ nên đạo hàm riêng tương ứng là $0$:</p><p>$$\frac{\partial{y_3}}{\partial{W_{7,8}}}=0$$</p><p>Tuy vậy, $y_3$ lại phụ thuộc vào cột thứ 3 của ma trận $\mathbf{W}$ nên đạo hàm riêng của nó theo các phần tử cột này là khác không, ví dụ đạo hàm riêng của $y_3$ theo $W_{2,3}$ là:</p><p>$$\frac{\partial{y_3}}{\partial{W_{2,3}}}=x_2$$</p><p>Một cách tổng quát, ta có:
$$
\frac{\partial{y_i}}{\partial{W_{j,k}}} = \begin{cases}
x_j ~~~ \text{if } i=k
\cr
0 ~~~ \text{otherwise}
\end{cases}
$$</p><p>Nếu ta gọi $\mathsf{F}\in\mathbb{R}^{mnn}$ là ten-xơ 3 chiều biểu diễn cho đạo hàm của vec-tơ $\mathbf{y}\in\mathbb{R}^{1n}$ theo ma trận $\mathbf{W}\in\mathbb{R}^{mn}$:
$$F_{i,j,k}=\frac{\partial{y_i}}{\partial{W_{j,k}}}$$</p><p>Khi đó, ta có:
$$
F_{i,j,k} = \begin{cases}
x_j ~~~ \text{if } i=k
\cr
0 ~~~ \text{otherwise}
\end{cases}
$$</p><p>Nếu sử dụng ma trận $\mathbf{G}\in\mathbb{R}^{mn}$, sao cho:
$$G_{i,j}=F_{i,j,i}$$</p><p>thì ta có thể thấy rằng $\mathbf{G}$ có thể lưu trữ đầy đủ thông tin đạo hàm riêng, hay nói cách khác ta có thể sử dụng dữ liệu 2 chiều để biểu diễn đạo hàm của thay vì dữ liệu 3 chiều như ten-xơ $\mathsf{F}$ ở trên.</p><blockquote><p>Lưu ý tới điểm này bởi nó rất hay được sử dụng khi tính đạo hàm trong mạng NN để tận dụng khả năng tính toán của các thư viện.</p></blockquote><h1 id=2-2-ví-dụ-2>2.2. Ví dụ 2</h1><p>Ở ví dụ này, thay vì véc-tơ $\mathbf{x}\in\mathbb{R}^{1,m}$ ta tổng quát hoá thành ma trận $\mathbf{X}\in\mathbb{R}^{nm}$, ta có:</p><p>$$\mathbf{Y}=\mathbf{X}\mathbf{W}$$</p><p>Lúc đó, mỗi thành phần của $\mathbf{Y}$ sẽ được biểu diễn như sau:
$$Y_{i,j}=\sum_{k=1}^mX_{i,k}W_{k,j}$$</p><p>Dễ dàng có thể thấy đạo hàm riêng của $Y_{a,b}$ theo $X_{c,d}$ là:
$$
\frac{\partial{Y_{a,b}}}{\partial{X_{c,d}}} = \begin{cases}
W_{d,b} ~~~ \text{if } a=c
\cr
0 ~~~ \text{otherwise}
\end{cases}
$$</p><p>Nếu lấy $\mathbf{Y}_{i,:}$ là hàng thứ $i$ của $\mathbf{Y}$ và $\mathbf{X}_{i,:}$ là hàng thứ $i$ của $\mathbf{X}$ thì rõ ràng:
$$\frac{\partial{\mathbf{Y}_{i,:}}}{\partial{\mathbf{X}_{i,:}}}=W$$</p><p>Đây cũng chính là trường hợp tổng quát của công thức tính đạo hàm ở <a href=#1-4-ho%C3%A1n-%C4%91%E1%BB%95i-vec-t%C6%A1-c%E1%BB%99t-v%E1%BB%9Bi-h%C3%A0ng>phần 1</a>.</p><h1 id=3-quy-tắc-chuỗi>3. Quy tắc chuỗi</h1><p>Quy tắc chuỗi dùng để tính <a href=https://dominhhai.github.io/vi/2017/10/multi-var-func/#5-đạo-hàm-riêng-của-hàm-hợp>đạo hàm của hàm hợp</a> sẽ được áp dụng thế nào cho các phép kết hợp của véc-tơ, ma trận?</p><p>Giả sử, ta có các véc-tơ cột $\mathbf{y}$ và $\mathbf{x}$:
$$\mathbf{y} = \mathbf{V}\mathbf{W}\mathbf{x}$$</p><p>Thử tính đạo hàm của $\mathbf{y}$ theo $\mathbf{x}$ xem sao. Đầu tiên ta nhận xét rằng, tích của 2 ma trận $\mathbf{V}$ và $\mathbf{W}$ chỉ đơn giản là một ma trận khác $\mathbf{U}$, vì thế ta có:
$$\frac{d\mathbf{y}}{d\mathbf{x}}=\mathbf{V}\mathbf{W}=\mathbf{U}$$</p><p>Tuy nhiên, để hiểu được quy tắc chuỗi áp dụng ra sao thì ta sẽ đưa vào các kết quả trung gian để sử dụng được quy tắc chuỗi trong trường hợp này. Giả sử véc-tơ $\mathbf{z}$ được định nghĩa như sau:
$$\mathbf{z}=\mathbf{W}\mathbf{x}$$</p><p>Thì:
$$\mathbf{y}=\mathbf{V}\mathbf{z}$$</p><p>Từ đây, ta có thể sử dụng quy tắc chuỗi như sau:
$$\frac{d\mathbf{y}}{d\mathbf{x}}=\frac{d\mathbf{y}}{d\mathbf{z}}\frac{d\mathbf{z}}{d\mathbf{x}}$$</p><p>Để chắc chắn rằng ta thực sự hiểu ý nghĩa của nó là gì, ta lại vận dụng chiến lược phân tách ở trên để phân tích các thành phần ra, bắt đầu với mỗi thành phần của véc-tơ $\mathbf{y}$ với mỗi thành phần của véc-tơ $\mathbf{x}$:</p><p>$$\frac{dy_i}{dx_j}=\frac{dy_i}{d\mathbf{z}}\frac{d\mathbf{z}}{dx_j}$$</p><p>Áp dụng tiếp <a href=https://dominhhai.github.io/vi/2017/10/multi-var-func/#5-đạo-hàm-riêng-của-hàm-hợp>quy tắc chuỗi của hàm nhiều biến</a>, giả sử rằng $\mathbf{z}$ có $K$ thành phần thì ta có:
$$\frac{dy_i}{dx_j}=\sum_{k=1}^K\frac{dy_i}{dz_k}\frac{dz_k}{dx_j}$$</p><p>Như đã chứng minh ở trên (đạo hàm của véc-tơ theo véc-tơ) thì ta có:
$$
\begin{aligned}
\frac{dy_i}{dz_k} &amp;= V_{i,k}
\cr
\frac{dz_k}{dx_j} &amp;= W_{k,j}
\end{aligned}
$$</p><p>Nên ta có:</p><p>$$\frac{dy_i}{dx_j}=\sum_{k=1}^KV_{i,k}W_{k,j}=\mathbf{V}_{i,:}\mathbf{W}_{:,j}$$</p><p>Tới đây, ta được điều phải chứng minh.</p><p>Như vậy, ta có thể sử dụng quy tắc chuỗi trong nhóm của các véc-tơ và ma trận bằng cách:</p><ul><li>Bóc tách các kết quả và biến trung gian để biểu diễn</li><li>Biểu diễn quy tắc chuỗi cho từng thành phân riêng của đạo hàm đích</li><li>Lấy tổng lại các kết quả trung gian với quy tắc chuỗi.</li></ul><blockquote><p>Tham khảo: <a href=http://cs231n.stanford.edu/vecDerivs.pdf>http://cs231n.stanford.edu/vecDerivs.pdf</a></p></blockquote></div></div><div id=post-footer class="post-footer main-content-wrap"><div class=post-footer-tags><span class="text-color-light text-small">THẺ ĐÁNH DẤU</span><br><a class="tag tag--primary tag--small" href=https://dominhhai.github.io/vi/tags/gi%E1%BA%A3i-t%C3%ADch/>Giải Tích</a>
<a class="tag tag--primary tag--small" href=https://dominhhai.github.io/vi/tags/%C4%91%E1%BA%A1o-h%C3%A0m/>Đạo Hàm</a></div><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://dominhhai.github.io/vi/2018/04/softmax-derivs/ data-tooltip="[Giải Tích] Softmax và đạo hàm"><i class="fa fa-angle-left"></i><span class="hide-xs hide-sm text-small icon-ml">Tiếp</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://dominhhai.github.io/vi/2018/04/nn-intro/ data-tooltip="[NN] Mạng nơ-ron nhân tạo - Neural Networks"><span class="hide-xs hide-sm text-small icon-mr">Trước</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions><i class="fa fa-share-alt"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://dominhhai.github.io/vi/2018/04/matrix-derivs/"><i class="fa fa-facebook-official"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://dominhhai.github.io/vi/2018/04/matrix-derivs/"><i class="fa fa-twitter"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://plus.google.com/share?url=https://dominhhai.github.io/vi/2018/04/matrix-derivs/"><i class="fa fa-google-plus"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#fb-cmt-thread><i class="fa fa-comment-o"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#table-of-contents><i class="fa fa-list"></i></a></li></ul></div><div id=fb-root></div><script>(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src='https://connect.facebook.net/vi_VN/sdk.js#xfbml=1&version=v3.1&appId=333198270561466&autoLogAppEvents=1';fjs.parentNode.insertBefore(js,fjs);}(document,'script','facebook-jssdk'));</script><div id=fb-cmt-thread class=fb-comments data-href=https://dominhhai.github.io/vi/2018/04/matrix-derivs/ data-width=100%></div></div></article><footer id=footer class=main-content-wrap><div id=helpinfo><div id=author><label id=home>Hai's Blog</label><div class=language><label for=language>Other Languages:</label>
<select id=language>
<option title="Tiếng Việt" value=vi selected>Tiếng Việt (vi)</option>
<option title=English value=en-us>English (en-us)</option>
<option title=日本語 value=ja>日本語 (ja)</option></select></div></div><div id=topic><label>Chủ đề</label><ul><li><a href=https://dominhhai.github.io/vi/categories/l%E1%BA%ADp-tr%C3%ACnh/>Lập Trình</a></li><li><a href=https://dominhhai.github.io/vi/categories/h%E1%BB%8Dc-m%C3%A1y/>Học Máy</a></li><li><a href=https://dominhhai.github.io/vi/categories/to%C3%A1n/>Toán</a></li><li><a href=https://dominhhai.github.io/vi/categories/x%C3%A1c-su%E1%BA%A5t/>Xác Suất</a></li><li><a href=https://dominhhai.github.io/vi/categories/s%C3%A1ch/>Sách</a></li></ul></div><div id=contact><label>Liên hệ</label><ul><li><a href=https://github.com/dominhhai/dominhhai.github.io/issues/new target=_blank><i class="fa fa-lg fa-inbox"></i>Gửi tin nhắn</a></li><li id=follow><a href=https://github.com/dominhhai target=_blank><i class="sidebar-button-icon fa fa-lg fa-github"></i></a><a href=https://twitter.com/minhhai3b target=_blank><i class="sidebar-button-icon fa fa-lg fa-twitter"></i></a></li></ul></div></div><div id=contentinfo><span class=copyrights>&copy; 2018 <a href=https://github.com/dominhhai>Do Minh Hai</a>. All Rights Reserved</span></div></footer></div><div id=bottom-bar class=post-bottom-bar data-behavior=5><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://dominhhai.github.io/vi/2018/04/softmax-derivs/ data-tooltip="[Giải Tích] Softmax và đạo hàm"><i class="fa fa-angle-left"></i><span class="hide-xs hide-sm text-small icon-ml">Tiếp</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://dominhhai.github.io/vi/2018/04/nn-intro/ data-tooltip="[NN] Mạng nơ-ron nhân tạo - Neural Networks"><span class="hide-xs hide-sm text-small icon-mr">Trước</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions><i class="fa fa-share-alt"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://dominhhai.github.io/vi/2018/04/matrix-derivs/"><i class="fa fa-facebook-official"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://dominhhai.github.io/vi/2018/04/matrix-derivs/"><i class="fa fa-twitter"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://plus.google.com/share?url=https://dominhhai.github.io/vi/2018/04/matrix-derivs/"><i class="fa fa-google-plus"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#fb-cmt-thread><i class="fa fa-comment-o"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#table-of-contents><i class="fa fa-list"></i></a></li></ul></div></div><div id=share-options-bar class=share-options-bar data-behavior=5><i id=btn-close-shareoptions class="fa fa-close"></i><ul class=share-options><li class=share-option><a class=share-option-btn target=new href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdominhhai.github.io%2Fvi%2F2018%2F04%2Fmatrix-derivs%2F"><i class="fa fa-facebook-official"></i><span>Chia sẻ với Facebook</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fdominhhai.github.io%2Fvi%2F2018%2F04%2Fmatrix-derivs%2F"><i class="fa fa-twitter"></i><span>Chia sẻ với Twitter</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://plus.google.com/share?url=https%3A%2F%2Fdominhhai.github.io%2Fvi%2F2018%2F04%2Fmatrix-derivs%2F"><i class="fa fa-google-plus"></i><span>Chia sẻ với Google&#43;</span></a></li></ul></div><div id=share-options-mask class=share-options-mask></div></div><div id=about><div id=about-card><div id=about-btn-close><i class="fa fa-remove"></i></div><img id=about-card-picture src="https://www.gravatar.com/avatar/711b36be8e444cd1d60b348077bfd752?s=110" alt="Ảnh đại diện"><h4 id=about-card-name>Do Minh Hai</h4><div id=about-card-bio>Just a developer<br>Enjoy life as a journey</div><div id=about-card-job><i class="fa fa-briefcase"></i><br>Freelancer</div><div id=about-card-location><i class="fa fa-map-marker"></i><br>Japan</div></div></div><div id=cover style=background-image:url(https://dominhhai.github.io/images/cover-v1.2.0.jpg)></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin=anonymous></script><script src=https://dominhhai.github.io/js/script-qi9wbxp2ya2j6p7wx1i6tgavftewndznf4v0hy2gvivk1rxgc3lm7njqb6bz.min.js></script><script crossorigin=anonymous integrity=sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js></script><script crossorigin=anonymous integrity=sha384-IiI65aU9ZYub2MY9zhtKd1H2ps7xxf+eb2YFG9lX6uRqpXCvBTOidPRCXCrQ++Uc src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/contrib/auto-render.min.js></script><script src=https://dominhhai.github.io/js/main.js></script><script>$(document).ready(function(){hljs.configure({classPrefix:'',useBR:false});$('pre.code-highlight > code, pre > code').each(function(i,block){if(!$(this).hasClass('codeblock')){$(this).addClass('codeblock');}
hljs.highlightBlock(block);});});</script><script>var disqus_config=function(){this.page.url='https:\/\/dominhhai.github.io\/vi\/2018\/04\/matrix-derivs\/';this.page.identifier='\/vi\/2018\/04\/matrix-derivs\/'};(function(){if(window.location.hostname=="localhost"){return;}
var d=document,s=d.createElement('script');var disqus_shortname='tranquilpeak';s.src='//'+disqus_shortname+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><script>if(typeof fnMain==='function'){fnMain();}</script></body></html>